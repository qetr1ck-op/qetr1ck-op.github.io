
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Blog | qetr1ck-op">
    <title>Development with Webpack and React part 5 - Blog | qetr1ck-op</title>
    <meta name="author" content="Orest Prystayko">
    
    
        <link rel="icon" href="http://qetr1ck-op.github.io/assets/images/favicon.ico">
    
    
    <meta name="description" content="We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of Lane.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Development with Webpack and React part 5">
<meta property="og:url" content="http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/index.html">
<meta property="og:site_name" content="Blog | qetr1ck-op">
<meta property="og:description" content="We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of Lane.">
<meta property="og:image" content="http://qetr1ck-op.github.io/img2.png">
<meta property="og:image" content="http://qetr1ck-op.github.io/img3.jpg">
<meta property="og:updated_time" content="2016-06-28T09:25:54.751Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Development with Webpack and React part 5">
<meta name="twitter:description" content="We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of Lane.">
<meta name="twitter:image" content="http://qetr1ck-op.github.io/img2.png">
<meta name="twitter:creator" content="@https://twitter.com/oprystayko">
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/35948c039f71fe48d765768c07bfee67?s=640"/>
    
    
        <meta property="og:image" content="http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/img.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/img.png" />
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-1ypxditl810oa2orjiy9qe0qftgjjwkw3blohah9riklnmw8hqbje2kp8z1m.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">Blog | qetr1ck-op</a>
    </h1>
    
        
            <a  class="header-right-icon st-search-show-outputs"
                href="#search">
        
        
            <i class="fa fa-lg fa-search"></i>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="4">
    
        <div class="sidebar-profile">
            <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/35948c039f71fe48d765768c07bfee67?s=110"/>
            </a>
            <span class="sidebar-profile-name">Orest Prystayko</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link st-search-show-outputs"
                         href="#search"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">Search</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/qetr1ck-op" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://www.linkedin.com/profile/preview?locale=ru_RU&trk=prof-0-sb-preview-primary-button" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
                    <span class="sidebar-button-desc">global.linked_in</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://twitter.com/oprystayko" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
                    <span class="sidebar-button-desc">Twitter</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://www.facebook.com/orest.prustayko" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
                    <span class="sidebar-button-desc">Facebook</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            Development with Webpack and React part 5
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" datetime="2016-02-21T12:02:24+02:00">
	
		    Feb 21, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Javascript/">Javascript</a>


    
</div>

</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>We still have work to do to turn this into a real Kanban as pictured above. Most importantly our system is missing the concept of Lane.</p>
<h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Extracting_Lanes"><span class="toc-text">Extracting Lanes</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modeling_Lane"><span class="toc-text">Modeling Lane</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Making_Lanes_Responsible_of_Notes"><span class="toc-text">Making Lanes Responsible of Notes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting_Up_attachToLane"><span class="toc-text">Setting Up attachToLane</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting_Up_detachFromLane"><span class="toc-text">Setting Up detachFromLane</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementing_a_Getter_for_NoteStore"><span class="toc-text">Implementing a Getter for NoteStore</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Connecting_Lane_with_the_Logic"><span class="toc-text">Connecting Lane with the Logic</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#On_Data_Dependencies_and_waitFor"><span class="toc-text">On Data Dependencies and waitFor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Implementing_Edit/Remove_for_Lane"><span class="toc-text">Implementing Edit/Remove for Lane</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pointing_Notes_to_Editable"><span class="toc-text">Pointing Notes to Editable</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Connecting_Lane_with_Editable"><span class="toc-text">Connecting Lane with Editable</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Defining_Editable_Logic"><span class="toc-text">Defining Editable Logic</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Styling_Kanban_Board"><span class="toc-text">Styling Kanban Board</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#On_Namespacing_Components"><span class="toc-text">On Namespacing Components</span></a></li></ol>
<a id="more"></a>
<p>A <code>Lane</code> is something that should be able to contain many <code>Notes</code> within itself and track their order.</p>
<h1 id="Extracting_Lanes"><a href="#Extracting_Lanes" class="headerlink" title="Extracting Lanes"></a>Extracting Lanes</h1><p>There will be a component for the higher level (i.e., <code>Lanes</code>) and for the lower level (i.e., <code>Lane</code>). The higher level component will deal with lane ordering. A <code>Lane</code> will render itself (i.e., name and <code>Notes</code>) and have basic manipulation operations.</p>
<p>Just as with Notes, we are going to need a set of actions:</p>
<figure class="highlight javascript"><figcaption><span>app/actions/LaneActions.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.generateActions(<span class="string">'create'</span>);</span><br></pre></td></tr></table></figure>
<p>In addition, we are going to need a <code>LaneStore</code> and a method matching to create:</p>
<figure class="highlight javascript"><figcaption><span>app/stores/LaneStore.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid <span class="keyword">from</span> <span class="string">'node-uuid'</span>;</span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"><span class="keyword">import</span> LaneActions <span class="keyword">from</span> <span class="string">'../actions/LaneActions'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LaneStore</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.bindActions(LaneActions);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.lanes = [];</span><br><span class="line">  &#125;</span><br><span class="line">  create(lane) &#123;</span><br><span class="line">    <span class="keyword">const</span> lanes = <span class="keyword">this</span>.lanes;</span><br><span class="line"></span><br><span class="line">    lane.id = uuid.v4();</span><br><span class="line">    lane.notes = lane.notes || [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      lanes: lanes.concat(lane)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.createStore(LaneStore, <span class="string">'LaneStore'</span>);</span><br></pre></td></tr></table></figure>
<p>We are also going to need a stub for <code>Lanes</code>:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Lanes.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="symbol">'reac</span>t';</span><br><span class="line"></span><br><span class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Lanes</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"lanes"</span>&gt;</span><br><span class="line">        lanes should go here</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, we need to make room for <code>Lanes</code> at <code>App</code>. We will simply replace Notes references with <code>Lanes</code>, set up actions, and store as needed:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/App.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> AltContainer <span class="keyword">from</span> <span class="string">'alt-container'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Lanes <span class="keyword">from</span> <span class="string">'./Lanes.jsx'</span>;</span><br><span class="line"><span class="keyword">import</span> LaneActions <span class="keyword">from</span> <span class="string">'../actions/LaneActions'</span>;</span><br><span class="line"><span class="keyword">import</span> LaneStore <span class="keyword">from</span> <span class="string">'../stores/LaneStore'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AltContainer</span></span><br><span class="line">          <span class="attr">stores</span>=<span class="string">&#123;[LaneStore]&#125;</span></span><br><span class="line">          <span class="attr">inject</span>=<span class="string">&#123;&#123;</span></span><br><span class="line">            <span class="attr">lanes:</span> () =&gt;</span> LaneStore.getState().lanes || []</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">Lanes</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">AltContainer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  addLane() &#123;</span><br><span class="line">    LaneActions.create(&#123;name: 'New lane'&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>It just shows a plus button and lanes should go here text. Even the add button doesn’t work yet. We still need to model <code>Lane</code> and attach <code>Notes</code> to that to make this all work.</p>
<h1 id="Modeling_Lane"><a href="#Modeling_Lane" class="headerlink" title="Modeling Lane"></a>Modeling Lane</h1><p>The <code>Lanes</code> container will render each <code>Lane</code> separately. Each <code>Lane</code> in turn will then render associated <code>Notes</code>, just like our <code>App</code> did earlier.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Lanes.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Lane <span class="keyword">from</span> <span class="string">'./Lane.jsx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> (</span>&#123;lanes&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lanes"</span>&gt;</span>&#123;lanes.map(lane =&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">Lane</span> <span class="attr">className</span>=<span class="string">"lane"</span> <span class="attr">key</span>=<span class="string">&#123;lane.id&#125;</span> <span class="attr">lane</span>=<span class="string">&#123;lane&#125;</span> /&gt;</span></span><br><span class="line">    )&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>We are also going to need a <code>Lane</code> component to make this work. It will render the <code>Lane</code> name and associated <code>Notes</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Lane.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> AltContainer <span class="keyword">from</span> <span class="string">'alt-container'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Notes <span class="keyword">from</span> <span class="string">'./Notes.jsx'</span>;</span><br><span class="line"><span class="keyword">import</span> NoteActions <span class="keyword">from</span> <span class="string">'../actions/NoteActions'</span>;</span><br><span class="line"><span class="keyword">import</span> NoteStore <span class="keyword">from</span> <span class="string">'../stores/NoteStore'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Lane</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;lane, ...props&#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> &#123;<span class="attr">...props</span>&#125;&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-header"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-add-note"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.addNote&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-name"</span>&gt;</span>&#123;lane.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AltContainer</span></span><br><span class="line">          <span class="attr">stores</span>=<span class="string">&#123;[NoteStore]&#125;</span></span><br><span class="line">          <span class="attr">inject</span>=<span class="string">&#123;&#123;</span></span><br><span class="line">            <span class="attr">notes:</span> () =&gt;</span> NoteStore.getState().notes || []</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">Notes</span> <span class="attr">onEdit</span>=<span class="string">&#123;this.editNote&#125;</span> <span class="attr">onDelete</span>=<span class="string">&#123;this.deleteNote&#125;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">AltContainer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  editNote(id, task) &#123;</span><br><span class="line">    // Don't modify if trying set an empty value</span><br><span class="line">    if(!task.trim()) &#123;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NoteActions.update(&#123;id, task&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  addNote() &#123;</span><br><span class="line">    NoteActions.create(&#123;task: 'New task'&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  deleteNote(id) &#123;</span><br><span class="line">    NoteActions.delete(id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p><code>const {a, b, ...props} = this.props</code> in the example. This allows us to attach a <code>className</code> to <code>Lane</code> and we avoid polluting it with HTML attributes we don’t need. The syntax expands Object key value pairs as props so we don’t have to write each prop we want separately.</p>
<p>If you run the application and try adding new notes, you can see there’s something wrong. Every note you add is shared by all lanes. If a note is modified, other lanes update too.</p>
<p><img src="/img2.png" alt=""></p>
<p>The reason why this happens is simple. Our <code>NoteStore</code> is a singleton. This means every component that is listening to <code>NoteStore</code> will receive the same data. We will need to resolve this problem somehow.</p>
<h1 id="Making_Lanes_Responsible_of_Notes"><a href="#Making_Lanes_Responsible_of_Notes" class="headerlink" title="Making Lanes Responsible of Notes"></a>Making Lanes Responsible of Notes</h1><p>Currently, our <code>Lane</code> contains just an array of objects. Each of the objects knows its id and name. We’ll need something more.</p>
<p>In order to make this work, each <code>Lane</code> needs to know which <code>Notes</code> belong to it. If a <code>Lane</code> contained an array of Note ids, it could then filter and display the <code>Notes</code> belonging to it. We’ll implement a scheme to achieve this next.</p>
<h2 id="Setting_Up_attachToLane"><a href="#Setting_Up_attachToLane" class="headerlink" title="Setting Up attachToLane"></a>Setting Up <code>attachToLane</code></h2><p>When we add a new <code>Note</code> to the system using <code>addNote</code>, we need to make sure it’s associated to some <code>Lane</code>. This association can be modeled using a method, such as <code>LaneActions.attachToLane({laneId: &lt;id&gt;, noteId: &lt;id&gt;})</code>. Before calling this method we should create a note and gets its id.</p>
<p>To get started we should add <code>attachToLane</code> to actions as before:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/actions/LaneActions.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.generateActions(<span class="string">'create'</span>, <span class="string">'attachToLane'</span>);</span><br></pre></td></tr></table></figure>
<p>In order to implement attachToLane, we need to find a lane matching to the given lane id and then attach note id to it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/stores/LaneStore.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid <span class="keyword">from</span> <span class="string">'node-uuid'</span>;</span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"><span class="keyword">import</span> LaneActions <span class="keyword">from</span> <span class="string">'../actions/LaneActions'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LaneStore</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  attachToLane(&#123;laneId, noteId&#125;) &#123;</span><br><span class="line">    <span class="keyword">const</span> lanes = <span class="keyword">this</span>.lanes.map(lane =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span>(lane.id === laneId) &#123;</span><br><span class="line">        <span class="keyword">if</span>(lane.notes.includes(noteId)) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">'Already attached note to lane'</span>, lanes);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">          lane.notes.push(noteId);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> lane;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;lanes&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.createStore(LaneStore, <span class="string">'LaneStore'</span>);</span><br></pre></td></tr></table></figure>
<p>We also need to make sure <code>NoteActions.create</code> returns a <code>note</code> so the setup works just like in the code example above. The note is needed for creating an association between a lane and a note:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/stores/NoteStore.js</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoteStore</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.bindActions(NoteActions);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.notes = [];</span><br><span class="line">  &#125;</span><br><span class="line">  create(note) &#123;</span><br><span class="line">    const notes = <span class="keyword">this</span>.notes;</span><br><span class="line"></span><br><span class="line">    note.id = uuid.v4();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      notes: notes.concat(note)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> note;</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="Setting_Up_detachFromLane"><a href="#Setting_Up_detachFromLane" class="headerlink" title="Setting Up detachFromLane"></a>Setting Up <code>detachFromLane</code></h2><p><code>deleteNote</code> is the opposite operation of <code>addNote</code>.</p>
<p>Again, we should set up an action:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/actions/LaneActions.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'./libs/alt'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.generateActions(<span class="string">'create'</span>, <span class="string">'attachToLane'</span>, <span class="string">'detachFromLane'</span>);</span><br></pre></td></tr></table></figure>
<p>The implementation will resemble <code>attachToLane</code>. In this case, we’ll remove the possibly found <code>Note</code> instead:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/stores/LaneStore.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid <span class="keyword">from</span> <span class="string">'node-uuid'</span>;</span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"><span class="keyword">import</span> LaneAction <span class="keyword">from</span> <span class="string">'../libs/action/LaneActions'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LaneStore</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  ...</span><br><span class="line">  attachToLane(&#123;laneId, noteId&#125;) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  detachFromLane(&#123;laneId, noteId&#125;) &#123;</span><br><span class="line">    <span class="keyword">const</span> lanes = <span class="keyword">this</span>.lanes.map( lane =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (lane.id === laneId) &#123;</span><br><span class="line">        lane.notes = lane.notes.filter( note =&gt; note.id !=== noteId );</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> lanes;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;lanes&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.createStore(LaneStore, <span class="string">'LaneStore'</span>);</span><br></pre></td></tr></table></figure>
<p>Just building an association between a lane and a note <em>isn’t enough</em>. We are going to need some way to resolve the note references to data we can display through the user interface. For this purpose, we need to implement a special <em>getter</em> so we get just the data we want per each lane.</p>
<h2 id="Implementing_a_Getter_for_NoteStore"><a href="#Implementing_a_Getter_for_NoteStore" class="headerlink" title="Implementing a Getter for NoteStore"></a>Implementing a Getter for NoteStore</h2><p>One neat way to resolve lane notes to actual data is to implement a public method <code>NoteStore.getNotesByIds(notes)</code>. It accepts an array of <code>Note</code> ids, and returns the corresponding objects.</p>
<p>Just implementing the method isn’t enough. We also need to make it public. In <code>Alt</code>, this can be achieved using <code>this.exportPublicMethods</code>:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/sotes/NoteStore.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid from <span class="string">'node-uuid'</span>;</span><br><span class="line"><span class="keyword">import</span> alt from <span class="string">'../libs/alt'</span>;</span><br><span class="line"><span class="keyword">import</span> NoteActions from <span class="string">'../actions/NoteActions'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoteStore</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.bindActions(NoteActions);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.notes = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.exportPublicMethods(&#123;</span><br><span class="line">      getNotesById: <span class="keyword">this</span>.getNotesById.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">  getNoteByIds(ids) &#123;</span><br><span class="line">    <span class="comment">// 1. Make sure we are operating on an array and</span></span><br><span class="line">    <span class="comment">// map over the ids</span></span><br><span class="line">    <span class="comment">// [id, id, id, ...] -&gt; [[Note], [], [Note], ...]</span></span><br><span class="line">    <span class="keyword">return</span> (ids || []).map( </span><br><span class="line">      <span class="comment">// 2. Extract matching notes</span></span><br><span class="line">      <span class="comment">// [Note, Note, Note] -&gt; [Note, ...] (match) or [] (no match)</span></span><br><span class="line">      id =&gt; <span class="keyword">this</span>.notes.filter( note.id === id )</span><br><span class="line">    )</span><br><span class="line">    <span class="comment">// 3. Filter out possible empty arrays and get notes</span></span><br><span class="line">    <span class="comment">// [[Note], [], [Note]] -&gt; [[Note], [Note]] -&gt; [Note, Note]</span></span><br><span class="line">    .filter( ary =&gt; ary.length )</span><br><span class="line">    .map( ary =&gt; ary[<span class="number">0</span>] );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export defalt alt.createStore(NoteStore, <span class="string">'NoteStore'</span>);</span><br></pre></td></tr></table></figure>
<p>Note that the implementation filters possible non-matching ids from the result.</p>
<h1 id="Connecting_Lane_with_the_Logic"><a href="#Connecting_Lane_with_the_Logic" class="headerlink" title="Connecting Lane with the Logic"></a>Connecting Lane with the Logic</h1><p>Now that we have the logical bits together, we can integrate it with <code>Lane</code>. We’ll need to take the newly added <code>props</code> (<code>id</code>, <code>notes</code>) into account, and glue this all together:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Lane.jsx</span></span><br><span class="line">...</span><br><span class="line">import LaneActions <span class="keyword">from</span> <span class="string">'./app/actions/LaneActions'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Lane</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;lane, ...props&#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> &#123;<span class="attr">...props</span>&#125;&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-header"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-add-note"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.addNote&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"lane-name"</span>&gt;</span>&#123;lane.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AltContainer</span></span><br><span class="line">          <span class="attr">stores</span>=<span class="string">&#123;[NoteStore]&#125;</span></span><br><span class="line">          <span class="attr">inject</span>=<span class="string">&#123;&#123;</span></span><br><span class="line">            <span class="attr">notes:</span> () =&gt;</span> NoteStore.getNotesById(lane.notes)</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">Notes</span> <span class="attr">onEdit</span>=<span class="string">&#123;this.onEdit&#125;</span> <span class="attr">onDelete</span>=<span class="string">&#123;this.onDelete&#125;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">AltContainer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  editNote(id, task) &#123;</span><br><span class="line">    // Don't modify if trying set an empty value</span><br><span class="line">    if(!task.trim()) &#123;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NoteActions.update(&#123;id, task&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  addNote = (e) =&gt; &#123;</span><br><span class="line">    const laneId = this.props.lane.id;</span><br><span class="line">    const noteId = NoteAction.create( &#123;task: 'New Task'&#125; ).id;</span><br><span class="line"></span><br><span class="line">    LaneAction.attachToLane(&#123; noteId, laneId &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  addNote = (noteId, e) =&gt; &#123;</span><br><span class="line">    const laneId = this.props.lane.id;</span><br><span class="line">    </span><br><span class="line">    NoteAction.delete(noteId);</span><br><span class="line">    LaneAction.detachFronLane(&#123; noteId, laneId &#125;);</span><br><span class="line">    </span><br><span class="line">    e.stopPropagation();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>There are three important changes:</p>
<ol>
<li>Methods where we need to refer to this have been bound using a <em>property initializer</em>. An alternative way to achieve this would have been to bind at <code>render</code> or at <code>constructor</code>.</li>
<li><code>notes: () =&gt; NoteStore.getNotesByIds(notes)</code> - Our new getter is used to filter notes.</li>
<li><code>addNote</code>, <code>deleteNote</code> - These operate now based on the new logic we specified. Note that we trigger detachFromLane before delete at <code>deleteNote</code>. Otherwise we may try to render non-existent notes. You can try swapping the order to see warnings.</li>
</ol>
<p>The current structure allows us to keep singleton stores and a flat data structure. Dealing with references is a little awkward, but that’s consistent with the Flux architecture.</p>
<p>If you try to add notes to a specific lane, they shouldn’t be duplicated anymore. Also editing a note should behave as you might expect:</p>
<p><img src="/img3.jpg" alt=""></p>
<h1 id="On_Data_Dependencies_and_waitFor"><a href="#On_Data_Dependencies_and_waitFor" class="headerlink" title="On Data Dependencies and waitFor"></a>On Data Dependencies and <code>waitFor</code></h1><p>The current setup works because our actions are synchronous. It would become more problematic if we dealt with a back-end. In that case, we would have to set up <code>waitFor</code> based code. <a href="http://alt.js.org/guide/wait-for/" target="_blank" rel="external">waitFor</a> allows us to deal with data dependencies. It tells the dispatcher that it should wait before going on:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/stores/LaneStore.js</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">class</span> <span class="selector-tag">LaneStore</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="selector-tag">attachToLane</span>( &#123;<span class="selector-tag">laneId</span>, <span class="selector-tag">noteId</span>&#125; ) &#123;</span><br><span class="line">    <span class="selector-tag">if</span>(!noteId) &#123;</span><br><span class="line">        this<span class="selector-class">.waitFor</span>(NoteStore);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// last note -&gt; id</span></span><br><span class="line">        noteId = NoteStore<span class="selector-class">.getState</span>()<span class="selector-class">.notes</span><span class="selector-class">.slice</span>(-<span class="number">1</span>)<span class="selector-attr">[0]</span><span class="selector-class">.id</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It becomes necessary when you need to deal with asynchronously fetched data that depends on each other, however.</p>
<h1 id="Implementing_Edit/Remove_for_Lane"><a href="#Implementing_Edit/Remove_for_Lane" class="headerlink" title="Implementing Edit/Remove for Lane"></a>Implementing Edit/Remove for Lane</h1><p>We are still missing some basic functionality, such as editing and removing lanes. For now, we just want to get <code>Editable</code> into a good condition:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/component/Editable.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React from <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Editable</span> <span class="title">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; value, onEdit, onDelete, onValueClick, editing, ...props &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div ...props&gt;</span><br><span class="line">        &#123;editing ? <span class="keyword">this</span>.renderEdit() : <span class="keyword">this</span>.renderValue()&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  renderEdit = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;input type=<span class="string">"text"</span></span><br><span class="line">        ref=&#123;</span><br><span class="line">          (e) =&gt; e ? e.selectionStart = <span class="keyword">this</span>.props.value.length : <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">        autoFocus=&#123;<span class="literal">true</span>&#125;</span><br><span class="line">        defaultValue=&#123;<span class="keyword">this</span>.props.value&#125;</span><br><span class="line">        onBlur=&#123;<span class="keyword">this</span>.finishEdit&#125;</span><br><span class="line">        onKeyPress=&#123;<span class="keyword">this</span>.checkEnter&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  renderValue = () =&gt; &#123;</span><br><span class="line">    const onDelete = <span class="keyword">this</span>.props.onDelete;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div onClick=&#123;<span class="keyword">this</span>.props.onValueClick&#125;&gt;</span><br><span class="line">        &lt;span className=<span class="string">"value"</span>&gt;&#123;<span class="keyword">this</span>.props.value&#125;&lt;/span&gt;</span><br><span class="line">        &#123;onDelete ? <span class="keyword">this</span>.renderDelete() : <span class="literal">null</span> &#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  renderDelete = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button</span><br><span class="line">        className=<span class="string">"onDelete"</span></span><br><span class="line">        onClick=&#123;<span class="keyword">this</span>.props.onDelete&#125;</span><br><span class="line">      &gt;x</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  checkEnter = (e) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(e.key === <span class="string">'Enter'</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.finishEdit()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  finishEdit = (e) =&gt; &#123;</span><br><span class="line">    <span class="keyword">this</span>.props.onClick(e.target.value);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Editable</code> uses uncontrolled design with its input. This means we pass the control over its state to DOM and capture it through event handlers. If you wanted to validate the input when the user is typing, it would be useful to convert it into a controlled design. In this case you would define a onChange handler and a value prop. It’s more work, but also provides more control. React documentation discusses <a href="https://facebook.github.io/react/docs/forms.html" target="_blank" rel="external">controlled components</a> in greater detail.</p>
<h2 id="Pointing_Notes_to_Editable"><a href="#Pointing_Notes_to_Editable" class="headerlink" title="Pointing Notes to Editable"></a>Pointing <code>Notes</code> to <code>Editable</code></h2><p>Next, we need to make <code>Notes.jsx</code> point at the new component. We’ll need to alter the import and the component name at <code>render()</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Notes.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Editable <span class="keyword">from</span> <span class="string">'./Editable.jsx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;notes, onValueClick, onEdit, onDelete&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">className</span>=<span class="string">"notes"</span>&gt;</span>&#123;notes.map(note =&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">"note"</span> <span class="attr">key</span>=<span class="string">&#123;note.id&#125;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Editable</span></span><br><span class="line">          <span class="attr">editing</span>=<span class="string">&#123;note.editing&#125;</span></span><br><span class="line">          <span class="attr">value</span>=<span class="string">&#123;note.task&#125;</span></span><br><span class="line">          <span class="attr">onValueClick</span>=<span class="string">&#123;onValueClick.bind(null,</span> <span class="attr">note.id</span>)&#125;</span><br><span class="line">          <span class="attr">onEdit</span>=<span class="string">&#123;onEdit.bind(null,</span> <span class="attr">note.id</span>)&#125;</span><br><span class="line">          <span class="attr">onDelete</span>=<span class="string">&#123;onDelete.bind(null,</span> <span class="attr">note.id</span>)&#125; /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    )&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Connecting_Lane_with_Editable"><a href="#Connecting_Lane_with_Editable" class="headerlink" title="Connecting Lane with Editable"></a>Connecting <code>Lane</code> with <code>Editable</code></h2><p>Next, we can use this generic component to allow a Lane’s name to be modified:</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/components/Lane.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Editable from <span class="string">'./Editable.jsx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Lane</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;lane, ...props&#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">return</span> (</span><br><span class="line">      &lt;div &#123;...props&#125;&gt;</span><br><span class="line">         &lt;div className=<span class="string">"lane-header"</span> onClick=&#123;<span class="keyword">this</span>.activateLaneEdit&#125;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;div className=<span class="string">"lane-add-note"</span>&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="keyword">this</span>.addNote&#125;&gt;+&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;Editable className=<span class="string">"lane-name"</span> editing=&#123;lane.editing&#125;</span><br><span class="line">            value=&#123;lane.name&#125; onEdit=&#123;<span class="keyword">this</span>.editName&#125; /&gt;</span><br><span class="line">          &lt;div className=<span class="string">"lane-delete"</span>&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="keyword">this</span>.deleteLane&#125;&gt;x&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;AltContainer</span><br><span class="line">          stores=&#123;[NoteStore]&#125;</span><br><span class="line">          inject=&#123;&#123;</span><br><span class="line">            notes: () =&gt; NoteStore.getNotesByIds(lane.notes)</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;Notes</span><br><span class="line">            onValueClick=&#123;<span class="keyword">this</span>.activateNoteEdit&#125;</span><br><span class="line">            onEdit=&#123;<span class="keyword">this</span>.editNote&#125;</span><br><span class="line">            onDelete=&#123;<span class="keyword">this</span>.deleteNote&#125; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/AltContainer&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  editNote(id, task) &#123;</span><br><span class="line">    <span class="comment">// Don't modify if trying set an empty value</span></span><br><span class="line">    <span class="keyword">if</span>(!task.trim()) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NoteActions.update(&#123;id, task&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  addNote = (e) =&gt; &#123;</span><br><span class="line">    <span class="comment">// If note is added, avoid opening lane name edit by stopping</span></span><br><span class="line">    <span class="comment">// event bubbling in this case.</span></span><br><span class="line">    e.stopPropagation();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line">    <span class="keyword">const</span> note = NoteActions.create(&#123;task: <span class="string">'New task'</span>&#125;);</span><br><span class="line"></span><br><span class="line">    LaneActions.attachToLane(&#123;</span><br><span class="line">      noteId: note.id,</span><br><span class="line">      laneId</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  ...</span><br><span class="line">  editName = (name) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    console.log(`edit lane $&#123;laneId&#125; name using $&#123;name&#125;`);</span><br><span class="line">  &#125;;</span><br><span class="line">  deleteLane = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    console.log(`delete lane $&#123;laneId&#125;`);</span><br><span class="line">  &#125;;</span><br><span class="line">  activateLaneEdit = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    console.log(`activate lane $&#123;laneId&#125; edit`);</span><br><span class="line">  &#125;;</span><br><span class="line">  activateNoteEdit(id) &#123;</span><br><span class="line">    console.log(`activate note $&#123;id&#125; edit`);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Defining_Editable_Logic"><a href="#Defining_Editable_Logic" class="headerlink" title="Defining Editable Logic"></a>Defining Editable Logic</h2><p>We will need to define some logic to make this work. To follow the same idea as with <code>Note</code>, we can model the remaining CRUD actions here. We’ll need to set up <code>update</code> and <code>delete</code> actions in particular.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/actions/LaneActions.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> alt <span class="keyword">from</span> <span class="string">'../libs/alt'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> alt.generateActions(</span><br><span class="line">  <span class="string">'create'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>,</span><br><span class="line">  <span class="string">'attachToLane'</span>, <span class="string">'detachFromLane'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>We are also going to need <code>LaneStore</code> level implementations for these. They can be modeled based on what we have seen in <code>NoteStore</code> earlier:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/stores/LaneStore.js</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LaneStore</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  create(lane) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  update(updatedLane) &#123;</span><br><span class="line">    const lanes = <span class="keyword">this</span>.lanes.map(lane =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span>(lane.id === updatedLane.id) &#123;</span><br><span class="line">        <span class="keyword">return</span> Object.assign(&#123;&#125;, lane, updatedLane);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> lane;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;lanes&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  delete(id) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      lanes: <span class="keyword">this</span>.lanes.filter(lane =&gt; lane.id !== id)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  attachToLane(&#123;laneId, noteId&#125;) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export <span class="keyword">default</span> alt.createStore(LaneStore, <span class="string">'LaneStore'</span>);</span><br></pre></td></tr></table></figure>
<p>Now that we have resolved actions and store, we need to adjust our component to take these changes into account:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/component/Lane.jsx</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Lane</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> &#123;</span></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  editNote(id, task) &#123;</span><br><span class="line">    <span class="comment">// Don't modify if trying set an empty value</span></span><br><span class="line">    <span class="keyword">if</span>(!task.trim()) &#123;</span><br><span class="line">      NoteActions.update(&#123;id, <span class="string">editing:</span> <span class="literal">false</span>&#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NoteActions.update(&#123;id, task, <span class="string">editing:</span> <span class="literal">false</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  editName = (name) =&gt; &#123;</span><br><span class="line">    const laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Don't modify if trying set an empty value</span></span><br><span class="line">    <span class="keyword">if</span>(!name.trim()) &#123;</span><br><span class="line">      LaneActions.update(&#123;<span class="string">id:</span> laneId, <span class="string">editing:</span> <span class="literal">false</span>&#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LaneActions.update(&#123;<span class="string">id:</span> laneId, name, <span class="string">editing:</span> <span class="literal">false</span>&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  deleteLane = () =&gt; &#123;</span><br><span class="line">    const laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    LaneActions.delete(laneId);</span><br><span class="line">  &#125;;</span><br><span class="line">  activateLaneEdit = () =&gt; &#123;</span><br><span class="line">    const laneId = <span class="keyword">this</span>.props.lane.id;</span><br><span class="line"></span><br><span class="line">    LaneActions.update(&#123;<span class="string">id:</span> laneId, <span class="string">editing:</span> <span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  activateNoteEdit(id) &#123;</span><br><span class="line">    NoteActions.update(&#123;id, <span class="string">editing:</span> <span class="literal">true</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If you want that lanes and notes are editable after they are created, set <code>lane.editing = true;</code> or <code>note.editing = true;</code> when creating them.</p>
<h1 id="Styling_Kanban_Board"><a href="#Styling_Kanban_Board" class="headerlink" title="Styling Kanban Board"></a>Styling Kanban Board</h1><p>As we added Lanes to the application, the styling went a bit off. Add the following styling to make it a little nicer:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/main.css</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: cornsilk;</span><br><span class="line">  <span class="attribute">font-family</span>: sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1em</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#efefef</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.5em</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">10em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane-header</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1em</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#efefef</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">0.5em</span>;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">0.5em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane-name</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane-add-note</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">0.5em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane-delete</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">0.5em</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.lane-header</span>:hover <span class="selector-class">.lane-delete</span> &#123;</span><br><span class="line">  <span class="attribute">visibility</span>: visible;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.add-lane</span>, <span class="selector-class">.lane-add-note</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdfdfd</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.lane-delete</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">background-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>As this is a small project, we can leave the CSS in a single file like this. In case it starts growing, consider separating it to multiple files. One way to do this is to extract CSS per component and then refer to it there (e.g., <code>require(&#39;./lane.css&#39;)</code> at <code>Lane.jsx</code>).</p>
<p>Besides keeping things nice and tidy, Webpack’s lazy loading machinery can pick this up. As a result, the initial CSS your user has to load will be smaller.</p>
<h1 id="On_Namespacing_Components"><a href="#On_Namespacing_Components" class="headerlink" title="On Namespacing Components"></a>On Namespacing Components</h1><p>TODO</p>

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Alt/">Alt</a> <a class="tag tag--primary tag--small t-link" href="/tags/Babel/">Babel</a> <a class="tag tag--primary tag--small t-link" href="/tags/ES6/">ES6</a> <a class="tag tag--primary tag--small t-link" href="/tags/React/">React</a> <a class="tag tag--primary tag--small t-link" href="/tags/Webpack/">Webpack</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/07/08/How-to-copy-object-in-Javascript/"  data-tooltip="How to copy object in Javascript">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/02/19/Kata-String-Format-a-string-of-names-like-Bart-Lisa-Maggie/" data-tooltip="Kata: Format a string of names like &#39;Bart, Lisa &amp; Maggie&#39;">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2016 Orest Prystayko. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/07/08/How-to-copy-object-in-Javascript/"  data-tooltip="How to copy object in Javascript">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/02/19/Kata-String-Format-a-string-of-names-like-Bart-Lisa-Maggie/" data-tooltip="Kata: Format a string of names like &#39;Bart, Lisa &amp; Maggie&#39;">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/35948c039f71fe48d765768c07bfee67?s=110"/>
        
            <h4 id="about-card-name">Orest Prystayko</h4>
        
            <h5 id="about-card-bio"><p>I try to learn something new every day. It may relate to personal finances, physical health, algorithms, computer programming. And the learning process might take place for a few minutes or from sunrise to sunset. I bealive that every time when I achieve new knowledge, I tipically observe how increase my quality of live.</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Front End Developer @ Eleks</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Ukraine, Lviv
            </h5>
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover-v2.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script-a0qmhtjwmff0mtcdvqzxlmmd4alojbs605wbemrsuzz1jwdrglwa58u354hf.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'http://qetr1ck-op.github.io/2016/02/21/Development-with-Webpack-and-React-part-5/';
                 
                    this.page.identifier = '2016/02/21/Development-with-Webpack-and-React-part-5/';
                                  
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'qetr1ck-op';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    


    <script type="text/javascript">
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
                (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
            e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','yjp7PCgxKmcfHTQ63jfa','2.0.0');
    </script>


</html>
